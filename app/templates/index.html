<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Price Predictor</title>
    <link rel="stylesheet" href="/static/style.css?v=2.0">
    <style>
        /* Ë≤°ÂãôÂ∑•Á®ãÈ¢®Ê†ºÁöÑÂÖßËÅØÊ®£Âºè */
        body {
            font-family: 'Roboto', sans-serif;
            background: 
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/><path d="M10,80 L20,70 L30,75 L40,60 L50,45 L60,50 L70,35 L80,40 L90,25" fill="none" stroke="rgba(0,200,81,0.3)" stroke-width="2"/><path d="M15,85 L25,78 L35,82 L45,65 L55,50 L65,55 L75,42 L85,47 L95,30" fill="none" stroke="rgba(255,68,68,0.3)" stroke-width="2"/><circle cx="30" cy="75" r="1.5" fill="rgba(0,200,81,0.5)"/><circle cx="50" cy="45" r="1.5" fill="rgba(0,200,81,0.5)"/><circle cx="70" cy="35" r="1.5" fill="rgba(0,200,81,0.5)"/><circle cx="35" cy="82" r="1.5" fill="rgba(255,68,68,0.5)"/><circle cx="55" cy="50" r="1.5" fill="rgba(255,68,68,0.5)"/><circle cx="75" cy="42" r="1.5" fill="rgba(255,68,68,0.5)"/><text x="5" y="15" fill="rgba(255,255,255,0.2)" font-size="8" font-family="monospace">$124.56</text><text x="55" y="15" fill="rgba(255,255,255,0.2)" font-size="8" font-family="monospace">+2.34%</text><text x="5" y="95" fill="rgba(255,255,255,0.2)" font-size="8" font-family="monospace">Vol: 12.5M</text></svg>'),
                linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f4c75 50%, #3282b8 75%, #bbe1fa 100%);
            background-size: 200px 200px, cover;
            color: #fff;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            position: relative;
        }

        @keyframes stockTicker {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 40px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            position: relative;
            background: linear-gradient(45deg, #3282b8, #bbe1fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }

        h1::after {
            content: "üìä AAPL $150.23 ‚Üó | NVDA $425.87 ‚Üó | TSLA $241.05 ‚Üò | MSFT $331.45 ‚Üó | GOOGL $138.21 ‚Üò | META $285.73 ‚Üó | AMZN $127.74 ‚Üó | JPM $194.85 ‚Üó | V $256.92 ‚Üó | COIN $85.43 ‚Üò | BABA $78.92 ‚Üó | SPY $428.15 ‚Üó";
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            white-space: nowrap;
            animation: stockTicker 45s linear infinite;
            font-family: 'Courier New', monospace;
            -webkit-text-fill-color: rgba(255, 255, 255, 0.7);
        }

        form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        @keyframes borderScan {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        form::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #3282b8, transparent);
            animation: borderScan 3s infinite;
        }

        button {
            background: linear-gradient(45deg, #3282b8, #0f4c75) !important;
            color: #fff !important;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            position: relative;
            overflow: hidden;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        button:hover {
            background: linear-gradient(45deg, #bbe1fa, #3282b8) !important;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(50, 130, 184, 0.4);
        }

        button:hover::before {
            left: 100%;
        }

        canvas {
            margin-top: 20px;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95), rgba(22, 33, 62, 0.95)) !important;
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }

        /* KÊ£íÂúñÂÆπÂô® */
        #trend-chart {
            width: 100% !important;
            height: 100% !important;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(50, 130, 184, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(187, 225, 250, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(15, 76, 117, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        #result {
            color: #fff;
            font-weight: 600;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px 20px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ËÇ°ÂÉπÈ†êÊ∏¨Á∂≤Á´ô</h1>
    <form id="stock-form">
        <label for="stock-code">ÈÅ∏ÊìáËÇ°Á•®‰ª£Á¢ºÔºö</label>
        <select id="stock-code" name="stock-code">
            <!-- ÁßëÊäÄÂ∑®È†≠ -->
            <optgroup label="üñ•Ô∏è ÁßëÊäÄÂ∑®È†≠">
                <option value="AAPL">AAPL - Apple Inc.</option>
                <option value="GOOGL">GOOGL - Alphabet Inc.</option>
                <option value="MSFT">MSFT - Microsoft Corp.</option>
                <option value="META">META - Meta Platforms</option>
                <option value="AMZN">AMZN - Amazon.com Inc.</option>
                <option value="ORCL">ORCL - Oracle Corp.</option>
                <option value="CRM">CRM - Salesforce Inc.</option>
                <option value="ADBE">ADBE - Adobe Inc.</option>
            </optgroup>
            
            <!-- ÂçäÂ∞éÈ´îËàáAI -->
            <optgroup label="üî¨ ÂçäÂ∞éÈ´î & AI">
                <option value="NVDA">NVDA - NVIDIA Corp.</option>
                <option value="AMD">AMD - Advanced Micro Devices</option>
                <option value="INTC">INTC - Intel Corp.</option>
                <option value="TSM">TSM - Taiwan Semiconductor</option>
                <option value="QCOM">QCOM - Qualcomm Inc.</option>
                <option value="AVGO">AVGO - Broadcom Inc.</option>
            </optgroup>
            
            <!-- ÈõªÂãïËªäËàáËÉΩÊ∫ê -->
            <optgroup label="üöó ÈõªÂãïËªä & ËÉΩÊ∫ê">
                <option value="TSLA">TSLA - Tesla Inc.</option>
                <option value="F">F - Ford Motor Co.</option>
                <option value="GM">GM - General Motors</option>
                <option value="RIVN">RIVN - Rivian Automotive</option>
                <option value="LCID">LCID - Lucid Group</option>
            </optgroup>
            
            <!-- ‰∏≤ÊµÅÂ™íÈ´îËàáÂ®õÊ®Ç -->
            <optgroup label="üé¨ Â™íÈ´îÂ®õÊ®Ç">
                <option value="NFLX">NFLX - Netflix Inc.</option>
                <option value="DIS">DIS - Walt Disney Co.</option>
                <option value="WBD">WBD - Warner Bros Discovery</option>
                <option value="PARA">PARA - Paramount Global</option>
            </optgroup>
            
            <!-- ÈáëËûçÊúçÂãô -->
            <optgroup label="üè¶ ÈáëËûçÊúçÂãô">
                <option value="JPM">JPM - JPMorgan Chase</option>
                <option value="BAC">BAC - Bank of America</option>
                <option value="GS">GS - Goldman Sachs</option>
                <option value="V">V - Visa Inc.</option>
                <option value="MA">MA - Mastercard Inc.</option>
                <option value="PYPL">PYPL - PayPal Holdings</option>
            </optgroup>
            
            <!-- ÁîüÁâ©ÁßëÊäÄËàáÈÜ´ÁôÇ -->
            <optgroup label="üß¨ ÁîüÊäÄÈÜ´ÁôÇ">
                <option value="JNJ">JNJ - Johnson & Johnson</option>
                <option value="PFE">PFE - Pfizer Inc.</option>
                <option value="MRNA">MRNA - Moderna Inc.</option>
                <option value="ABBV">ABBV - AbbVie Inc.</option>
                <option value="UNH">UNH - UnitedHealth Group</option>
            </optgroup>
            
            <!-- Âä†ÂØÜË≤®Âπ£Áõ∏Èóú -->
            <optgroup label="‚Çø Âä†ÂØÜË≤®Âπ£">
                <option value="COIN">COIN - Coinbase Global</option>
                <option value="MSTR">MSTR - MicroStrategy</option>
                <option value="HOOD">HOOD - Robinhood Markets</option>
            </optgroup>
            
            <!-- ‰∏≠Ê¶ÇËÇ° -->
            <optgroup label="üá®üá≥ ‰∏≠Ê¶ÇËÇ°">
                <option value="BABA">BABA - Alibaba Group</option>
                <option value="JD">JD - JD.com Inc.</option>
                <option value="PDD">PDD - PDD Holdings</option>
                <option value="BIDU">BIDU - Baidu Inc.</option>
                <option value="NIO">NIO - NIO Inc.</option>
            </optgroup>
            
            <!-- ETF -->
            <optgroup label="üìä ETF">
                <option value="SPY">SPY - SPDR S&P 500 ETF</option>
                <option value="QQQ">QQQ - Invesco QQQ Trust</option>
                <option value="IWM">IWM - iShares Russell 2000</option>
                <option value="VTI">VTI - Vanguard Total Stock Market</option>
            </optgroup>
        </select>
        <label for="time-range" style="margin-left: 20px;">ÊôÇÈñìÁØÑÂúçÔºö</label>
        <select id="time-range" name="time-range" style="margin-right: 10px;">
            <option value="1wk">1ÈÄ±</option>
            <option value="1mo" selected>1ÂÄãÊúà</option>
            <option value="3mo">3ÂÄãÊúà</option>
            <option value="6mo">6ÂÄãÊúà</option>
            <option value="1y">1Âπ¥</option>
        </select>
        <br><br>
        <button type="button" id="fetch-all">üìä Êü•Ë©¢‰∏¶È°ØÁ§∫Ë∂®Âã¢</button>
        <button type="button" id="add-favorite">‚≠ê Âä†ÂÖ•Êî∂Ëóè</button>
        <button type="button" id="predict-stock">üîÆ È†êÊ∏¨ËÇ°ÂÉπ</button>
        <button type="button" id="toggle-theme">üåô ÂàáÊèõ‰∏ªÈ°å</button>
    </form>
    
    <!-- Êî∂ËóèËÇ°Á•®ÂçÄÂüü -->
    <div id="favorites-section" style="margin: 10px 0;">
        <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px; backdrop-filter: blur(5px);">
            <strong>üìå ÊàëÁöÑÊî∂ËóèÔºö</strong>
            <div id="favorites-list" style="margin-top: 5px;">
                <span style="color: rgba(255,255,255,0.7); font-size: 0.9em;">Â∞öÁÑ°Êî∂ËóèËÇ°Á•®</span>
            </div>
        </div>
    </div>
    
    <form style="display: none;">
    </form>
    
    <div style="position: relative; height: 500px; width: 100%; max-width: 900px;">
        <canvas id="trend-chart"></canvas>
    </div>
    <div id="result" style="margin-top: 8px;"></div>
    <div id="prediction-result"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let chartInstance = null; // Áî®Êñº‰øùÂ≠òÂúñË°®ÂØ¶‰æã

        document.getElementById('fetch-all').addEventListener('click', async () => {
            const stockCode = document.getElementById('stock-code').value;
            const timeRange = document.getElementById('time-range').value;
            const response = await fetch(`/get_stock_data?stock_code=${stockCode}&period=${timeRange}`);
            const data = await response.json();

            if (data.error) {
                alert(`ÈåØË™§: ${data.error}`);
            } else {
                // È°ØÁ§∫Ë©≥Á¥∞Ë≥áË®ä
                const resultDiv = document.getElementById('result');
                const changeColor = data.price_change >= 0 ? '#00C851' : '#ff4444';
                const changeSymbol = data.price_change >= 0 ? '‚Üó' : '‚Üò';
                
                resultDiv.innerHTML = `
                    <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; backdrop-filter: blur(5px);">
                        <strong>${data.stock_code}</strong> | ÁõÆÂâç: <span style="font-size: 1.1em;">$${data.price.toFixed(2)}</span> | 
                        ÊúüÈñìËÆäÂãï: <span style="color: ${changeColor}; font-weight: bold;">${data.price_change >= 0 ? '+' : ''}${data.price_change} (${data.price_change_pct >= 0 ? '+' : ''}${data.price_change_pct}%) ${changeSymbol}</span>
                    </div>
                `;

                const canvas = document.getElementById('trend-chart');
                const ctx = canvas.getContext('2d');

                // Â¶ÇÊûúÂúñË°®Â∑≤Â≠òÂú®ÔºåÂÖàÈä∑ÊØÄÂÆÉ
                if (chartInstance) {
                    chartInstance.destroy();
                }

                // ‰ΩøÁî®Canvas APIÁõ¥Êé•Áπ™Ë£ΩKÊ£íÂúñ
                const drawCandlestickChart = () => {
                    const canvas = document.getElementById('trend-chart');
                    const ctx = canvas.getContext('2d');
                    
                    // Ë®≠ÁΩÆcanvasÂ∞∫ÂØ∏
                    canvas.width = canvas.offsetWidth;
                    canvas.height = canvas.offsetHeight;
                    
                    const padding = 60;
                    const chartWidth = canvas.width - 2 * padding;
                    const chartHeight = canvas.height - 2 * padding;
                    
                    // Ê∏ÖÈô§canvas
                    ctx.fillStyle = 'rgba(20, 20, 30, 0.95)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Ë®àÁÆóÂÉπÊ†ºÁØÑÂúç
                    const prices = data.history.flatMap(item => [item.High, item.Low]);
                    const minPrice = Math.min(...prices);
                    const maxPrice = Math.max(...prices);
                    const priceRange = maxPrice - minPrice;
                    
                    const candleWidth = Math.max(2, chartWidth / data.history.length * 0.7);
                    const spacing = chartWidth / data.history.length;
                    
                    // Áπ™Ë£ΩÊ®ôÈ°å
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 18px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(`${data.stock_code} KÁ∑öÂúñ (${data.period || '1mo'})`, canvas.width / 2, 30);
                    
                    // Áπ™Ë£ΩÁ∂≤Ê†ºÁ∑öÂíåÂ∫ßÊ®ôËª∏
                    ctx.strokeStyle = 'rgba(255,255,255,0.1)';
                    ctx.lineWidth = 1;
                    
                    // Ê∞¥Âπ≥Á∂≤Ê†ºÁ∑ö
                    for (let i = 0; i <= 5; i++) {
                        const y = padding + (chartHeight / 5) * i;
                        ctx.beginPath();
                        ctx.moveTo(padding, y);
                        ctx.lineTo(padding + chartWidth, y);
                        ctx.stroke();
                        
                        // ÂÉπÊ†ºÊ®ôÁ±§
                        const price = maxPrice - (priceRange / 5) * i;
                        ctx.fillStyle = '#fff';
                        ctx.font = '12px Arial';
                        ctx.textAlign = 'right';
                        ctx.fillText(`$${price.toFixed(2)}`, padding - 10, y + 4);
                    }
                    
                    // Áπ™Ë£ΩKÊ£í
                    data.history.forEach((item, index) => {
                        const x = padding + spacing * index + spacing / 2;
                        const open = item.Open;
                        const high = item.High;
                        const low = item.Low;
                        const close = item.Close;
                        
                        const openY = padding + (maxPrice - open) / priceRange * chartHeight;
                        const closeY = padding + (maxPrice - close) / priceRange * chartHeight;
                        const highY = padding + (maxPrice - high) / priceRange * chartHeight;
                        const lowY = padding + (maxPrice - low) / priceRange * chartHeight;
                        
                        // Âà§Êñ∑Êº≤Ë∑å
                        const isUp = close >= open;
                        const color = isUp ? '#00C851' : '#ff4444';
                        
                        // Áπ™Ë£ΩÂΩ±Á∑ö
                        ctx.strokeStyle = color;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(x, highY);
                        ctx.lineTo(x, lowY);
                        ctx.stroke();
                        
                        // Áπ™Ë£ΩÂØ¶È´î
                        const bodyTop = Math.min(openY, closeY);
                        const bodyHeight = Math.abs(closeY - openY) || 1;
                        
                        ctx.fillStyle = color;
                        ctx.fillRect(x - candleWidth/2, bodyTop, candleWidth, bodyHeight);
                        
                        // Â¶ÇÊûúÊòØ‰∏äÊº≤KÊ£íÔºåÂØ¶È´îÈÉ®ÂàÜ‰ΩøÁî®Á©∫ÂøÉ
                        if (isUp) {
                            ctx.fillStyle = 'rgba(20, 20, 30, 0.95)';
                            ctx.fillRect(x - candleWidth/2 + 1, bodyTop + 1, candleWidth - 2, Math.max(0, bodyHeight - 2));
                        }
                    });
                    
                    // Áπ™Ë£ΩÊó•ÊúüÊ®ôÁ±§
                    const dateStep = Math.max(1, Math.floor(data.history.length / 6));
                    data.history.forEach((item, index) => {
                        if (index % dateStep === 0 || index === data.history.length - 1) {
                            const x = padding + spacing * index + spacing / 2;
                            ctx.fillStyle = '#fff';
                            ctx.font = '10px Arial';
                            ctx.textAlign = 'center';
                            const date = new Date(item.Date).toLocaleDateString('zh-TW', {month: 'short', day: 'numeric'});
                            ctx.fillText(date, x, canvas.height - 10);
                        }
                    });
                    
                    // Â∫ßÊ®ôËª∏Ê®ôÁ±§
                    ctx.fillStyle = '#fff';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('Êó•Êúü', canvas.width / 2, canvas.height - 30);
                    
                    ctx.save();
                    ctx.translate(20, canvas.height / 2);
                    ctx.rotate(-Math.PI / 2);
                    ctx.fillText('ËÇ°ÂÉπ ($)', 0, 0);
                    ctx.restore();
                };
                
                // Âü∑Ë°åÁπ™Ë£Ω
                drawCandlestickChart();
            }
        });

        document.getElementById('predict-stock').addEventListener('click', async () => {
            const stockCode = document.getElementById('stock-code').value;
            const predictionDiv = document.getElementById('prediction-result');
            
            // È°ØÁ§∫ËºâÂÖ•‰∏≠ÁãÄÊÖã
            predictionDiv.innerHTML = '<div style="text-align: center;">üîÆ AIÊ≠£Âú®ÂàÜÊûêÈ†êÊ∏¨‰∏≠...</div>';
            
            try {
                const response = await fetch(`/predict_stock?stock_code=${stockCode}`);
                const data = await response.json();

                if (data.error) {
                    predictionDiv.innerHTML = `<div style="color: #ff4444;">‚ùå ${data.error}</div>`;
                } else {
                    // Âà§Êñ∑Êº≤Ë∑åÈ°èËâ≤
                    const changeColor = data.price_change >= 0 ? '#00C851' : '#ff4444';
                    const changeSymbol = data.price_change >= 0 ? '‚Üó' : '‚Üò';
                    
                    predictionDiv.innerHTML = `
                        <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; backdrop-filter: blur(5px);">
                            <h3 style="margin: 0 0 10px 0; color: #fff;">üìà ${data.stock_code} AI È†êÊ∏¨ÁµêÊûú</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <strong>ÁõÆÂâçÂÉπÊ†º:</strong><br>
                                    <span style="font-size: 1.2em;">$${data.current_price}</span>
                                </div>
                                <div>
                                    <strong>È†êÊ∏¨ÂÉπÊ†º:</strong><br>
                                    <span style="font-size: 1.2em; color: ${changeColor};">$${data.predicted_price} ${changeSymbol}</span>
                                </div>
                                <div>
                                    <strong>È†êÊ∏¨ËÆäÂãï:</strong><br>
                                    <span style="color: ${changeColor};">$${data.price_change}</span>
                                </div>
                                <div>
                                    <strong>ËÆäÂãïÂπÖÂ∫¶:</strong><br>
                                    <span style="color: ${changeColor}; font-weight: bold;">${data.price_change_pct}%</span>
                                </div>
                            </div>
                            <div style="margin-top: 10px; font-size: 0.9em; color: rgba(255,255,255,0.7);">
                                ‚ö†Ô∏è Ê≠§È†êÊ∏¨ÂÉÖ‰æõÂèÉËÄÉÔºåÊäïË≥áÊúâÈ¢®Èö™ÔºåË´ãË¨πÊÖéÊ±∫Á≠ñ
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                predictionDiv.innerHTML = `<div style="color: #ff4444;">‚ùå Á∂≤Ë∑ØÈåØË™§: ${error.message}</div>`;
            }
        });

        // Êî∂ËóèÂäüËÉΩ
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        
        function updateFavoritesList() {
            const favList = document.getElementById('favorites-list');
            if (favorites.length === 0) {
                favList.innerHTML = '<span style="color: rgba(255,255,255,0.7); font-size: 0.9em;">Â∞öÁÑ°Êî∂ËóèËÇ°Á•®</span>';
            } else {
                favList.innerHTML = favorites.map(stock => 
                    `<span style="background: rgba(50,130,184,0.3); padding: 3px 8px; margin: 2px; border-radius: 15px; display: inline-block; cursor: pointer;" 
                     onclick="selectStock('${stock}')" title="ÈªûÊìäÈÅ∏Êìá">${stock}</span>`
                ).join('');
            }
        }
        
        function selectStock(stockCode) {
            document.getElementById('stock-code').value = stockCode;
        }
        
        document.getElementById('add-favorite').addEventListener('click', () => {
            const stockCode = document.getElementById('stock-code').value;
            if (!favorites.includes(stockCode)) {
                favorites.push(stockCode);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                updateFavoritesList();
                alert(`‚úÖ ${stockCode} Â∑≤Âä†ÂÖ•Êî∂ËóèÔºÅ`);
            } else {
                alert(`‚ö†Ô∏è ${stockCode} Â∑≤Âú®Êî∂ËóèÊ∏ÖÂñÆ‰∏≠ÔºÅ`);
            }
        });
        
        // ÂàùÂßãÂåñÊî∂ËóèÊ∏ÖÂñÆ
        updateFavoritesList();

        const toggleThemeButton = document.getElementById('toggle-theme');
        toggleThemeButton.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
        });
    </script>
</body>
</html>
